
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <title>Asynchronous work helpers Â· GitBook</title>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.0.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="string_bytes.html" />
    
    
    <link rel="prev" href="callback.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="methods.html">
            
                <a href="methods.html">
            
                    
                    JavaScript-accessible methods
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="scopes.html">
            
                <a href="scopes.html">
            
                    
                    Scopes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="persistent.html">
            
                <a href="persistent.html">
            
                    
                    Persistent references
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="new.html">
            
                <a href="new.html">
            
                    
                    New
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="converters.html">
            
                <a href="converters.html">
            
                    
                    Converters
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="maybe_types.html">
            
                <a href="maybe_types.html">
            
                    
                    Maybe Types
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="script.html">
            
                <a href="script.html">
            
                    
                    Script
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="errors.html">
            
                <a href="errors.html">
            
                    
                    Errors
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="buffers.html">
            
                <a href="buffers.html">
            
                    
                    Buffers
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="callback.html">
            
                <a href="callback.html">
            
                    
                    Nan::Callback
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.12" data-path="asyncworker.html">
            
                <a href="asyncworker.html">
            
                    
                    Asynchronous work helpers
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13" data-path="string_bytes.html">
            
                <a href="string_bytes.html">
            
                    
                    Strings & Bytes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14" data-path="object_wrappers.html">
            
                <a href="object_wrappers.html">
            
                    
                    Object Wrappers
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15" data-path="v8_internals.html">
            
                <a href="v8_internals.html">
            
                    
                    V8 internals
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16" data-path="v8_misc.html">
            
                <a href="v8_misc.html">
            
                    
                    Miscellaneous V8 Helpers
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.17" data-path="node_misc.html">
            
                <a href="node_misc.html">
            
                    
                    Miscellaneous Node Helpers
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Asynchronous work helpers</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h2 id="asynchronous-work-helpers">Asynchronous work helpers</h2>
<p><code>Nan::AsyncWorker</code> and <code>Nan::AsyncProgressWorker</code> are helper classes that make working with asynchronous code easier.</p>
<ul>
<li><a href="#api_nan_async_worker"><b><code>Nan::AsyncWorker</code></b></a></li>
<li><a href="#api_nan_async_progress_worker"><b><code>Nan::AsyncProgressWorker</code></b></a></li>
<li><a href="#api_nan_async_queue_worker"><b><code>Nan::AsyncQueueWorker</code></b></a></li>
</ul>
<p><a name="api_nan_async_worker"></a></p>
<h3 id="nanasyncworker">Nan::AsyncWorker</h3>
<p><code>Nan::AsyncWorker</code> is an <em>abstract</em> class that you can subclass to have much of the annoying asynchronous queuing and handling taken care of for you. It can even store arbitrary V8 objects for you and have them persist while the asynchronous work is in progress.</p>
<p>Definition:</p>
<pre><code class="lang-c++"><span class="hljs-keyword">class</span> AsyncWorker {
 <span class="hljs-keyword">public</span>:
  <span class="hljs-function"><span class="hljs-keyword">explicit</span> <span class="hljs-title">AsyncWorker</span><span class="hljs-params">(Callback *callback_)</span></span>;

  <span class="hljs-keyword">virtual</span> ~AsyncWorker();

  <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">WorkComplete</span><span class="hljs-params">()</span></span>;

  <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">SaveToPersistent</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *key, <span class="hljs-keyword">const</span> v8::Local&lt;v8::Value&gt; &amp;value)</span></span>;

  <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">SaveToPersistent</span><span class="hljs-params">(<span class="hljs-keyword">const</span> v8::Local&lt;v8::String&gt; &amp;key,
                        <span class="hljs-keyword">const</span> v8::Local&lt;v8::Value&gt; &amp;value)</span></span>;

  <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">SaveToPersistent</span><span class="hljs-params">(uint32_t index,
                        <span class="hljs-keyword">const</span> v8::Local&lt;v8::Value&gt; &amp;value)</span></span>;

  v8::Local&lt;v8::Value&gt; GetFromPersistent(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *key) <span class="hljs-keyword">const</span>;

  v8::Local&lt;v8::Value&gt; GetFromPersistent(<span class="hljs-keyword">const</span> v8::Local&lt;v8::String&gt; &amp;key) <span class="hljs-keyword">const</span>;

  v8::Local&lt;v8::Value&gt; GetFromPersistent(<span class="hljs-keyword">uint32_t</span> index) <span class="hljs-keyword">const</span>;

  <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Execute</span><span class="hljs-params">()</span> </span>= <span class="hljs-number">0</span>;

  <span class="hljs-keyword">uv_work_t</span> request;

  <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Destroy</span><span class="hljs-params">()</span></span>;

 <span class="hljs-keyword">protected</span>:
  Persistent&lt;v8::Object&gt; persistentHandle;

  Callback *callback;

  <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">HandleOKCallback</span><span class="hljs-params">()</span></span>;

  <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">HandleErrorCallback</span><span class="hljs-params">()</span></span>;

  <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">SetErrorMessage</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *msg)</span></span>;

  <span class="hljs-function"><span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* <span class="hljs-title">ErrorMessage</span><span class="hljs-params">()</span></span>;
};
</code></pre>
<p><a name="api_nan_async_progress_worker"></a></p>
<h3 id="nanasyncprogressworker">Nan::AsyncProgressWorker</h3>
<p><code>Nan::AsyncProgressWorker</code> is an <em>abstract</em> class that extends <code>Nan::AsyncWorker</code> and adds additional progress reporting callbacks that can be used during the asynchronous work execution to provide progress data back to JavaScript.</p>
<p>Definition:</p>
<pre><code class="lang-c++"><span class="hljs-keyword">class</span> AsyncProgressWorker : <span class="hljs-keyword">public</span> AsyncWorker {
 <span class="hljs-keyword">public</span>:
  <span class="hljs-function"><span class="hljs-keyword">explicit</span> <span class="hljs-title">AsyncProgressWorker</span><span class="hljs-params">(Callback *callback_)</span></span>;

  <span class="hljs-keyword">virtual</span> ~AsyncProgressWorker();

  <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">WorkProgress</span><span class="hljs-params">()</span></span>;

  <span class="hljs-keyword">class</span> ExecutionProgress {
   <span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Signal</span><span class="hljs-params">()</span> <span class="hljs-keyword">const</span></span>;
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Send</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* data, size_t size)</span> <span class="hljs-keyword">const</span></span>;
  };

  <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Execute</span><span class="hljs-params">(<span class="hljs-keyword">const</span> ExecutionProgress&amp; progress)</span> </span>= <span class="hljs-number">0</span>;

  <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">HandleProgressCallback</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *data, size_t size)</span> </span>= <span class="hljs-number">0</span>;

  <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Destroy</span><span class="hljs-params">()</span></span>;
</code></pre>
<p><a name="api_nan_async_queue_worker"></a></p>
<h3 id="nanasyncqueueworker">Nan::AsyncQueueWorker</h3>
<p><code>Nan::AsyncQueueWorker</code> will run a <code>Nan::AsyncWorker</code> asynchronously via libuv. Both the <code>execute</code> and <code>after_work</code> steps are taken care of for you. Most of the logic for this is embedded in <code>Nan::AsyncWorker</code>.</p>
<p>Definition:</p>
<pre><code class="lang-c++"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">AsyncQueueWorker</span><span class="hljs-params">(AsyncWorker *)</span></span>;
</code></pre>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="callback.html" class="navigation navigation-prev " aria-label="Previous page: Nan::Callback">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="string_bytes.html" class="navigation navigation-next " aria-label="Next page: Strings & Bytes">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Asynchronous work helpers","level":"1.12","depth":1,"next":{"title":"Strings & Bytes","level":"1.13","depth":1,"path":"doc/string_bytes.md","ref":"doc/string_bytes.md","articles":[]},"previous":{"title":"Nan::Callback","level":"1.11","depth":1,"path":"doc/callback.md","ref":"doc/callback.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["livereload"],"pluginsConfig":{"livereload":{},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"doc/asyncworker.md","mtime":"2016-06-04T08:15:41.000Z","type":"markdown"},"gitbook":{"version":"3.0.3","time":"2016-06-04T08:16:55.353Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-livereload/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/buttons.js"></script>
        
    

    </body>
</html>

